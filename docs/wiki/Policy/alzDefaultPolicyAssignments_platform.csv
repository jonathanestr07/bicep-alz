"Name","DisplayName","Description","PolicyDefinitionId","EnforcementMode","AssignedBy","Scope","NotScopes","Parameters"
"Deploy-vmArc-ChangeTrack","Enable ChangeTracking and Inventory for Arc-enabled virtual machines","Enable ChangeTracking and Inventory for Arc-enabled virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations.","/providers/Microsoft.Authorization/policySetDefinitions/53448c70-089b-4f52-8f38-89196d7f2de1","Default","","*"," ","dcrResourceId.value=${dataCollectionRuleChangeTrackingResourceId};
effect.value=DeployIfNotExists"
"Deploy-VM-ChangeTrack","Enable ChangeTracking and Inventory for virtual machines","Enable ChangeTracking and Inventory for virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.","/providers/Microsoft.Authorization/policySetDefinitions/92a36f05-ebc9-4bba-9128-b47ad2ea3354","Default","","*"," ","dcrResourceId.value=${dataCollectionRuleChangeTrackingResourceId};
bringYourOwnUserAssignedManagedIdentity.value=True;
restrictBringYourOwnUserAssignedIdentityToSubscription.value=False;
userAssignedIdentityResourceId.value=${userAssignedManagedIdentityResourceId};
effect.value=DeployIfNotExists"
"Deploy-VMSS-ChangeTrack","Enable ChangeTracking and Inventory for virtual machine scale sets","Enable ChangeTracking and Inventory for virtual machine scale sets. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.","/providers/Microsoft.Authorization/policySetDefinitions/c4a70814-96be-461c-889f-2b27429120dc","Default","","*"," ","dcrResourceId.value=${dataCollectionRuleChangeTrackingResourceId};
bringYourOwnUserAssignedManagedIdentity.value=True;
restrictBringYourOwnUserAssignedIdentityToSubscription.value=False;
userAssignedIdentityResourceId.value=${userAssignedManagedIdentityResourceId};
effect.value=DeployIfNotExists"
"Deploy-vmHybr-Monitoring","Enable Azure Monitor for Hybrid Virtual Machines","Enable Azure Monitor for Hybrid Virtual Machines in the specified scope (Management group, Subscription or resource group).","/providers/Microsoft.Authorization/policySetDefinitions/2b00397d-c309-49c4-aa5a-f0b2c5bc6321","Default","","*"," ","dcrResourceId.value=${dataCollectionRuleVMInsightsResourceId};
enableProcessesAndDependencies.value=True;
effect.value=DeployIfNotExists"
"Deploy-VM-Monitor-24","Enable Azure Monitor for VMs","Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter.","/providers/Microsoft.Authorization/policySetDefinitions/924bfe3a-762f-40e7-86dd-5c8b95eb09e6","Default","","*"," ","dcrResourceId.value=${dataCollectionRuleVMInsightsResourceId};
enableProcessesAndDependencies.value=True;
scopeToSupportedImages.value=False;
bringYourOwnUserAssignedManagedIdentity.value=True;
restrictBringYourOwnUserAssignedIdentityToSubscription.value=False;
userAssignedIdentityResourceId.value=${userAssignedManagedIdentityResourceId};
effect.value=DeployIfNotExists"
"Deploy-MDFC-DefSQL-AMA","Enable Defender for SQL on SQL VMs and Arc-enabled SQL Servers","Microsoft Defender for SQL collects events from the agents and uses them to provide security alerts and tailored hardening tasks (recommendations).","/providers/Microsoft.Authorization/policySetDefinitions/de01d381-bae9-4670-8870-786f89f49e26","Default","","*"," ","userWorkspaceResourceId.value=/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/alz-logging/providers/Microsoft.OperationalInsights/workspaces/${topLevelManagementGroupPrefix}-la;
dcrResourceId.value=${dataCollectionRuleMDFCSQLResourceId};
bringYourOwnUserAssignedManagedIdentity.value=True;
bringYourOwnDcr.value=True;
userAssignedIdentityResourceId.value=${dataCollectionRuleMDFCSQLResourceId}"
"DenyAction-DeleteUAMIAMA","Do not allow deletion of the User Assigned Managed Identity used by AMA","This policy provides a safeguard against accidental removal of the User Assigned Managed Identity used by AMA by blocking delete calls using deny action effect.","${topLevelManagementGroupResourceId}/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DeleteResources","Default","","${current_scope_resource_id}"," ","effect.value=DenyAction;
resourceName.value=alz-umi-identity;
resourceType.value=Microsoft.ManagedIdentity/userAssignedIdentities"
"Deploy-VMSS-Monitor-24","Enable Azure Monitor for Virtual Machine Scale Sets","Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.","/providers/Microsoft.Authorization/policySetDefinitions/f5bf694c-cca7-4033-b883-3a23327d5485","Default","","*"," ","dcrResourceId.value=${dataCollectionRuleVMInsightsResourceId};
enableProcessesAndDependencies.value=True;
scopeToSupportedImages.value=False;
bringYourOwnUserAssignedManagedIdentity.value=True;
restrictBringYourOwnUserAssignedIdentityToSubscription.value=False;
userAssignedIdentityResourceId.value=${userAssignedManagedIdentityResourceId};
effect.value=DeployIfNotExists"
"Enforce-GR-KeyVault","Enforce recommended guardrails for Azure Key Vault","This initiative assignment enables recommended ALZ guardrails for Azure Key Vault.","${topLevelManagementGroupResourceId}/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault","Default","","*"," ","secretsValidPeriod.value=Audit"
"Enforce-ASR","Enforce enhanced recovery and backup policies","This initiative assignment enables recommended ALZ guardrails for Azure Recovery Services.","${topLevelManagementGroupResourceId}/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Backup","Default","","*"," ",""
"Enable-AUM-CheckUpdates","Configure periodic checking for missing system updates on azure virtual machines and Arc-enabled virtual machines.","Configure auto-assessment (every 24 hours) for OS updates. You can control the scope of assignment according to machine subscription, resource group, location or tag. Learn more about this for Windows: https://aka.ms/computevm-windowspatchassessmentmode, for Linux: https://aka.ms/computevm-linuxpatchassessmentmode.","${topLevelManagementGroupResourceId}/providers/Microsoft.Authorization/policySetDefinitions/Deploy-AUM-CheckUpdates","Default","","*"," ","assessmentMode.value=AutomaticByPlatform"
