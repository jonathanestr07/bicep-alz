"Name","DisplayName","Description","PolicyDefinitionId","EnforcementMode","AssignedBy","Scope","NotScopes","Parameters"
"Deploy-MDFC-Config-H224","Deploy Microsoft Defender for Cloud configuration","Deploy Microsoft Defender for Cloud configuration and Security Contacts","${topLevelManagementGroupResourceId}/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config_20240319","Default","","*"," ","emailSecurityContact.value=security_contact@replace_me;
logAnalytics.value=law-alz;
ascExportResourceGroupName.value=ascExportRG;
ascExportResourceGroupLocation.value=northeurope;
enableAscForServers.value=DeployIfNotExists;
enableAscForServersVulnerabilityAssessments.value=DeployIfNotExists;
enableAscForSql.value=DeployIfNotExists;
enableAscForAppServices.value=DeployIfNotExists;
enableAscForStorage.value=DeployIfNotExists;
enableAscForContainers.value=DeployIfNotExists;
enableAscForKeyVault.value=DeployIfNotExists;
enableAscForSqlOnVm.value=DeployIfNotExists;
enableAscForArm.value=DeployIfNotExists;
enableAscForOssDb.value=DeployIfNotExists;
enableAscForCosmosDbs.value=DeployIfNotExists;
enableAscForCspm.value=DeployIfNotExists"
"Deploy-MDEndpoints","[Preview]: Deploy Microsoft Defender for Endpoint agent","Deploy Microsoft Defender for Endpoint agent on applicable images.","/providers/Microsoft.Authorization/policySetDefinitions/e20d08c5-6d64-656d-6465-ce9e37fd0ebc","Default","","*"," ","microsoftDefenderForEndpointWindowsVmAgentDeployEffect.value=DeployIfNotExists;
microsoftDefenderForEndpointLinuxVmAgentDeployEffect.value=DeployIfNotExists;
microsoftDefenderForEndpointWindowsArcAgentDeployEffect.value=DeployIfNotExists;
microsoftDefenderForEndpointLinuxArcAgentDeployEffect.value=DeployIfNotExists"
"Deploy-MDEndpointsAMA","Configure multiple Microsoft Defender for Endpoint integration settings with Microsoft Defender for Cloud","Configure the multiple Microsoft Defender for Endpoint integration settings with Microsoft Defender for Cloud (WDATP, WDATP_EXCLUDE_LINUX_PUBLIC_PREVIEW, WDATP_UNIFIED_SOLUTION etc.). See: https://learn.microsoft.com/azure/defender-for-cloud/integration-defender-for-endpoint for more information.","/providers/Microsoft.Authorization/policySetDefinitions/77b391e3-2d5d-40c3-83bf-65c846b3c6a3","Default","","*"," ",""
"Deploy-AzActivity-Log","Deploy Diagnostic Settings for Activity Log to Log Analytics workspace","Ensures that Activity Log Diagnostics settings are set to push logs into Log Analytics workspace.","/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f","Default","","*"," ","effect.value=DeployIfNotExists;
logAnalytics.value=/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/${topLevelManagementGroupPrefix}-mgmt/providers/Microsoft.OperationalInsights/workspaces/${topLevelManagementGroupPrefix}-la"
"Deploy-ASC-Monitoring","Enable Monitoring in Microsoft Defender for Cloud","Enable Monitoring in Microsoft Defender for Cloud.","/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","Default","","*"," ",""
"Deploy-Diag-Logs","Enable allLogs category group resource logging for supported resources to Log Analytics","Resource logs should be enabled to track activities and events that take place on your resources and give you visibility and insights into any changes that occur. This initiative deploys diagnostic setting using the allLogs category group to route logs to an Event Hub for all supported resources.","/providers/Microsoft.Authorization/policySetDefinitions/0884adba-2312-4468-abeb-5422caed1038","Default","","*"," ","logAnalytics.value=/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/${topLevelManagementGroupPrefix}-mgmt/providers/Microsoft.OperationalInsights/workspaces/${topLevelManagementGroupPrefix}-la"
"Enforce-ACSB","Enforce Azure Compute Security Baseline compliance auditing","This initiative assignment enables Azure Compute Security Baseline compliance auditing for Windows and Linux virtual machines.","${topLevelManagementGroupResourceId}/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB","Default","","*"," ",""
"Deploy-MDFC-OssDb","Configure Advanced Threat Protection to be enabled on open-source relational databases","Enable Advanced Threat Protection on your non-Basic tier open-source relational databases to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. See https://aka.ms/AzDforOpenSourceDBsDocu.","/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e","Default","","*"," ",""
"Deploy-MDFC-SqlAtp","Configure Azure Defender to be enabled on SQL Servers and SQL Managed Instances","Enable Azure Defender on your SQL Servers and SQL Managed Instances to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.","/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97","Default","","*"," ",""
"Audit-Location-Match","Audit that the resource location matches its resource group location","Audit resource location matches resource group location","/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a","Default","","*"," ",""
"Audit-ZoneResiliency","Resources should be Zone Resilient","Resources should be Zone Resilient.","/providers/Microsoft.Authorization/policySetDefinitions/130fb88f-0fc9-4678-bfe1-31022d71c7d5","Default","","*"," ","effect.value=Audit;
allow.value=Both"
"Audit-UnusedResources","Unused resources driving cost should be avoided","This Policy initiative is a group of Policy definitions that help optimize cost by detecting unused but chargeable resources. Leverage this Policy initiative as a cost control to reveal orphaned resources that are driving cost.","${topLevelManagementGroupResourceId}/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization","Default","","*"," ","EffectDisks.value=Audit;
EffectPublicIpAddresses.value=Audit;
EffectServerFarms.value=Audit"
"Audit-TrustedLaunch","Audit virtual machines for Trusted Launch support","Trusted Launch improves security of a Virtual Machine which requires VM SKU, OS Disk & OS Image to support it (Gen 2). To learn more about Trusted Launch, visit https://aka.ms/trustedlaunch.","${topLevelManagementGroupResourceId}/providers/Microsoft.Authorization/policySetDefinitions/Audit-TrustedLaunch","Default","","*"," ",""
"Deny-UnmanagedDisk","Deny virtual machines and virtual machine scale sets that do not use managed disk","Deny virtual machines that do not use managed disk. It checks the managed disk property on virtual machine OS Disk fields.","/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","Default","","*"," ",""
"Deny-Classic-Resources","Deny the deployment of classic resources","Denies deployment of classic resource types under the assigned scope.","/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","Default","","*"," ","listOfResourceTypesNotAllowed.value=Microsoft.ClassicCompute/capabilities Microsoft.ClassicCompute/checkDomainNameAvailability Microsoft.ClassicCompute/domainNames Microsoft.ClassicCompute/domainNames/capabilities Microsoft.ClassicCompute/domainNames/internalLoadBalancers Microsoft.ClassicCompute/domainNames/serviceCertificates Microsoft.ClassicCompute/domainNames/slots Microsoft.ClassicCompute/domainNames/slots/roles Microsoft.ClassicCompute/domainNames/slots/roles/metricDefinitions Microsoft.ClassicCompute/domainNames/slots/roles/metrics Microsoft.ClassicCompute/moveSubscriptionResources Microsoft.ClassicCompute/operatingSystemFamilies Microsoft.ClassicCompute/operatingSystems Microsoft.ClassicCompute/operations Microsoft.ClassicCompute/operationStatuses Microsoft.ClassicCompute/quotas Microsoft.ClassicCompute/resourceTypes Microsoft.ClassicCompute/validateSubscriptionMoveAvailability Microsoft.ClassicCompute/virtualMachines Microsoft.ClassicCompute/virtualMachines/diagnosticSettings Microsoft.ClassicCompute/virtualMachines/metricDefinitions Microsoft.ClassicCompute/virtualMachines/metrics Microsoft.ClassicInfrastructureMigrate/classicInfrastructureResources Microsoft.ClassicNetwork/capabilities Microsoft.ClassicNetwork/expressRouteCrossConnections Microsoft.ClassicNetwork/expressRouteCrossConnections/peerings Microsoft.ClassicNetwork/gatewaySupportedDevices Microsoft.ClassicNetwork/networkSecurityGroups Microsoft.ClassicNetwork/operations Microsoft.ClassicNetwork/quotas Microsoft.ClassicNetwork/reservedIps Microsoft.ClassicNetwork/virtualNetworks Microsoft.ClassicNetwork/virtualNetworks/remoteVirtualNetworkPeeringProxies Microsoft.ClassicNetwork/virtualNetworks/virtualNetworkPeerings Microsoft.ClassicStorage/capabilities Microsoft.ClassicStorage/checkStorageAccountAvailability Microsoft.ClassicStorage/disks Microsoft.ClassicStorage/images Microsoft.ClassicStorage/operations Microsoft.ClassicStorage/osImages Microsoft.ClassicStorage/osPlatformImages Microsoft.ClassicStorage/publicImages Microsoft.ClassicStorage/quotas Microsoft.ClassicStorage/storageAccounts Microsoft.ClassicStorage/storageAccounts/blobServices Microsoft.ClassicStorage/storageAccounts/fileServices Microsoft.ClassicStorage/storageAccounts/metricDefinitions Microsoft.ClassicStorage/storageAccounts/metrics Microsoft.ClassicStorage/storageAccounts/queueServices Microsoft.ClassicStorage/storageAccounts/services Microsoft.ClassicStorage/storageAccounts/services/diagnosticSettings Microsoft.ClassicStorage/storageAccounts/services/metricDefinitions Microsoft.ClassicStorage/storageAccounts/services/metrics Microsoft.ClassicStorage/storageAccounts/tableServices Microsoft.ClassicStorage/storageAccounts/vmImages Microsoft.ClassicStorage/vmImages Microsoft.ClassicSubscription/operations;
effect.value=Deny"
